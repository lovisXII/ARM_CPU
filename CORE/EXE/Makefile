# Makefile automatically generated by ghdl
# Version: GHDL 0.37 (Ubuntu 0.37+dfsg-1ubuntu1) [Dunoon edition] - mcode code generator
# Command used to generate this makefile:
# ghdl --gen-makefile exec_tb
#export MBK_TARGET_LIB=/soc/alliance/cells/sxlib/
WORKDIR=../../work

MBK_TARGET_LIB?=/home/timo/Documents/Cours/alliance/alliance/src/cells/src/sxlib/
GHDL?=ghdl
GHDLFLAGS?=--workdir=$(WORKDIR)
GHDLRUNFLAGS?=
TB=exec_tb
COMPONENTS=exec alu ror shift_left shift_right shifter
MODS=$(COMPONENTS) $(TB)

# Default target : elaborate
all : elab

# Elaborate target.
elab : analyse
		$(GHDL) -c $(GHDLFLAGS) -e $(TB)

.PHONY: run clean

# Run target
run : elab
		./$(TB)

# Targets to analyze libraries
analyse: $(addsuffix .vhdl,$(MODS))
		cd ../util && make analyse
		$(GHDL) -a $(GHDLFLAGS) $^

clean:
		rm -f $(WORKDIR)/* *.vst *.vbe *.xsc

synth: exec_model.vst

shift_right.vbe: shift_right.vhdl
		vasy -I vhdl -V -o -a shift_right.vhdl shift_right

shift_right_o.vbe : shift_right.vbe
		boom -V shift_right shift_right_o

shift_right.vst : shift_right_o.vbe
		boog shift_right_o shift_right

shift_left.vbe: shift_left.vhdl
		vasy -I vhdl -V -o -a shift_left.vhdl shift_left

shift_left_o.vbe : shift_left.vbe
		boom -V shift_left shift_left_o

shift_left.vst : shift_left_o.vbe
		boog shift_left_o shift_left

ror.vbe: ror.vhdl
		vasy -I vhdl -V -o -a ror.vhdl ror

ror_o.vbe : ror.vbe
		boom -V ror ror_o

ror.vst : ror_o.vbe
		boog ror_o ror

shifter.vst : shifter.vhdl shift_left.vst shift_right.vst ror.vst
		vasy -I vhdl -V -o -a -p shifter.vhdl shifter

shifter_model_o.vbe : shifter.vst
		boom -V -O shifter_model shifter_model_o

shifter_model.vst : shifter_model_o.vbe
		boog shifter_model_o shifter_model

alu.vbe: alu.vhdl
		vasy -I vhdl -V -o -a alu.vhdl alu

alu_o.vbe : alu.vbe
		boom -V alu alu_o

alu.vst : alu_o.vbe
		boog alu_o alu

fifo_72b.vbe: fifo_72b.vhdl
		vasy -I vhdl -V -o -a fifo_72b.vhdl fifo_72b

fifo_72b_o.vbe : fifo_72b.vbe
		boom -V fifo_72b fifo_72b_o

fifo_72b.vst : fifo_72b_o.vbe
		boog fifo_72b_o fifo_72b


exec.vst : exec.vhdl fifo_72b.vst alu.vst shifter_model.vst
		vasy -I vhdl -V -o -a -p	 exec.vhdl exec

exec_model_o.vbe : exec.vst
		boom -V -O exec_model exec_model_o

exec_model.vst : exec_model_o.vbe
		boog exec_model_o exec_model